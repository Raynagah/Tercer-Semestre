--Caso 1--
SELECT
TO_CHAR (C.NUMRUN,'99G999G999')|| '-' || C.DVRUN AS "RUN CLIENTE",
INITCAP(C.PNOMBRE || ' ' || C.SNOMBRE || ' ' || C.APPATERNO || ' ' || C.APMATERNO) AS "NOMBRE CLIENTE", 
TO_CHAR(C.FECHA_NACIMIENTO,'dd " de " Month') as "DIA DE CUMPLEAÑOS",
MAX(SR.DIRECCION || '/' || R.NOMBRE_REGION) AS "Dirección Sucursal/REGION SUCURSAL"
FROM CLIENTE C

LEFT JOIN COMUNA CO ON C.COD_COMUNA = CO.COD_COMUNA
LEFT JOIN PROVINCIA P ON CO.COD_PROVINCIA = P.COD_PROVINCIA
LEFT JOIN REGION R ON P.COD_REGION = R.COD_REGION
LEFT JOIN SUCURSAL_RETAIL SR ON SR.COD_REGION = CO.COD_REGION

WHERE TO_CHAR(C.FECHA_NACIMIENTO,'MM') = TO_CHAR(ADD_MONTHS(SYSDATE,+5),'MM') AND (R.NOMBRE_REGION)='Metropolitana de Santiago'
GROUP BY C.NUMRUN, C.DVRUN,C.PNOMBRE,C.SNOMBRE,C.APPATERNO,C.APMATERNO, C.FECHA_NACIMIENTO
ORDER BY EXTRACT(DAY FROM C.FECHA_NACIMIENTO), C.APPATERNO
;


SELECT TTC.NRO_TARJETA,TC.NUMRUN, TTC.FECHA_TRANSACCION, TTC.COD_TPTRAN_TARJETA, TTT.NOMBRE_TPTRAN_TARJETA, TTC.ID_SUCURSAL, SR.DIRECCION
FROM TRANSACCION_TARJETA_CLIENTE TTC

INNER JOIN TARJETA_CLIENTE TC ON TTC.NRO_TARJETA = TC.NRO_TARJETA
INNER JOIN TIPO_TRANSACCION_TARJETA TTT ON TTC.COD_TPTRAN_TARJETA = TTT.COD_TPTRAN_TARJETA
INNER JOIN SUCURSAL_RETAIL SR ON TTC.ID_SUCURSAL = SR.ID_SUCURSAL

;
--Fin caso 1--


SELECT TTC.NRO_TARJETA, TTC.FECHA_TRANSACCION, 
TTC.COD_TPTRAN_TARJETA, TTT.NOMBRE_TPTRAN_TARJETA,
TTC.ID_SUCURSAL,
TTT.COD_PRODUCTO, P.NOMBRE_PRODUCTO
FROM TRANSACCION_TARJETA_CLIENTE TTC

INNER JOIN TIPO_TRANSACCION_TARJETA TTT ON TTC.COD_TPTRAN_TARJETA = TTT.COD_TPTRAN_TARJETA
INNER JOIN PRODUCTO P ON TTT.COD_PRODUCTO = P.COD_PRODUCTO


;


SELECT C.NUMRUN, C.PNOMBRE, C.COD_PROF_OFIC, PO.NOMBRE_PROF_OFIC

FROM CLIENTE C
RIGHT JOIN PROFESION_OFICIO PO ON C.COD_PROF_OFIC = PO.COD_PROF_OFIC

;




SELECT * FROM CLIENTE;
SELECT * FROM TARJETA_CLIENTE;

SELECT * FROM TIPO_TRANSACCION_TARJETA;

SELECT * FROM SUCURSAL_RETAIL;



