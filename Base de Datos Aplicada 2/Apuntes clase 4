-- CASO 1

SELECT CARRERAID AS "IDENTIFICACIÓN DE LA CARRERA",

COUNT(ALUMNOID) AS "TOTAL ALUMNOS MATRICULADOS",

'Le corresponden '||TO_CHAR(COUNT(ALUMNOID)*30200,'L999G999')

||' les presupuesto total asigando para publicidad' AS "MONTO POR PUBLICIDAD"

FROM ALUMNO

GROUP BY CARRERAID

ORDER BY COUNT(ALUMNOID) DESC;



SELECT TO_CHAR(1000,'L999G999') FROM DUAL;

-- SELECT * FROM ALUMNO;



-- CASO 2

SELECT CARRERAID AS CARRERA,

COUNT(ALUMNOID) AS "TOTAL DE ALUMNOS"

FROM ALUMNO

GROUP BY CARRERAID

HAVING COUNT(ALUMNOID)>4

ORDER BY CARRERAID;



-- CASO 2

-- CASO 3

SELECT 

TO_CHAR (RUN_JEFE,'99G999G999') as "RUN JEFE SIN DV",

COUNT(RUN_EMP) AS "TOTAL EMPLEADOS A SU CARGO",

TO_CHAR (MAX(SALARIO),'L999G999G999') AS "SALARIO MAXIMO",

COUNT(RUN_EMP)*10||'% del Salario Maximo' AS "PORCENTAJE DE BONIFICACION",

TO_CHAR (ROUND(MAX(SALARIO))*COUNT(RUN_EMP)/10,'L999G999') AS "BONIFICACION"
--TAMBIÉN SE PUEDE UTILIZAR MAX(SALARIO) * (COUNT(RUN_EMP)*10/100),'L99G999G999') AS "BONIFICACION"--

FROM EMPLEADO 

WHERE RUN_JEFE IS NOT NULL --APLICAMOS UNA RESTRICCIÓN PARA QUE MUESTRE TODOS LOS QUE NO SEAN NULOS--

GROUP BY RUN_JEFE 

ORDER BY RUN_JEFE ASC;

-- CASO 3

-- CASO 4   

SELECT 

ES.ID_ESCOLARIDAD AS "Escolaridad",

ES.DESC_ESCOLARIDAD AS "Descripcion escolaridad",

COUNT(E.ID_ESCOLARIDAD) AS "Total de empleados",

TO_CHAR(MAX(E.SALARIO), 'L9G999G999') AS "Salario maximo",

TO_CHAR(MIN(E.SALARIO), 'L9G999G999') AS "Salario minimo",

TO_CHAR(SUM(E.SALARIO), 'L9G999G999G999') AS "Salario total",

TO_CHAR(AVG(E.SALARIO), 'L9G999G999G999') AS "Salario promedio"

FROM EMPLEADO E

INNER JOIN ESCOLARIDAD_EMP ES ON E.ID_ESCOLARIDAD = ES.ID_ESCOLARIDAD

GROUP BY ES.ID_ESCOLARIDAD, ES.DESC_ESCOLARIDAD

ORDER BY COUNT(E.ID_ESCOLARIDAD) DESC;

-- CASO 4

--caso 5 (esta malo pero intente hacerlo esperare explicacion en calses)

SELECT 
T.TITULOID AS "CODIGO DEL LIBRO",
COUNT(PRESTAMOID) AS "TOTAL DE VECES SOLICITADO",

CASE --Es como usar if --
    WHEN (COUNT(P.PRESTAMOID)>5) THEN 'Se requiere comprar 4 nuevos ejemplares'
    WHEN (COUNT(P.PRESTAMOID)BETWEEN 4 AND 5) THEN 'Se requiere comprar 2 nuevos ejemplares'
    WHEN (COUNT(P.PRESTAMOID)BETWEEN 2 AND 3) THEN 'Se requiere comprar 1 nuevo ejemplares'
    ELSE 'No se requiere comprar nuevos ejemplares'
    END AS "SUGERENCIA"
FROM PRESTAMO P
JOIN TITULO T ON P.TITULOID = T.TITULOID
WHERE TO_CHAR(FECHA_INI_PRESTAMO,'YYYY')=TO_CHAR(SYSDATE,'YYYY')-1

GROUP BY T.TITULOID
ORDER BY COUNT(P.PRESTAMOID) DESC;
